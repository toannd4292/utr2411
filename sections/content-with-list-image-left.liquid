<style>
  @media(min-width:750px){
    #Eligibility .px-lg-2-2{padding-left:2rem}
  }
</style>
<div id="Eligibility" class="pt-lg-5 pt-sm-5">
  <div class="page-width pb-lg-5 pb-sm-5">
    <div class="grid grid--1-col grid--1-col-tablet grid--2-col-desktop justify-content-center align-items-center">
      <div class="grid__item">
        <div>
          <img class="img-fluid border-radius-lg-3 border-radius-sm-3" data-src="{{section.settings.section-image | image_url}}" loading="lazy" width="100" height="100" alt="Content List image Left"/>
        </div>
      </div>
      <div class="grid__item">
        <div class="px-lg-2-2">
  {% case section.settings['heading-size'] %}
      {% when 'h1' %}
        <h1 class="text-uppercase section-medium-title mt-0 mb-0 mt-sm-1 lh-xl-90 text-sm-center section-title-large ">
          {{ section.settings.heading }}
        </h1>
      {% when 'h2' %}
        <h2 class="text-uppercase section-medium-title mt-0 mb-0 mt-sm-1 lh-xl-90 text-sm-center section-title-medium">
          {{ section.settings.heading }}
        </h2>
      {% when 'h3' %}
        <h3 class="text-uppercase section-medium-title mt-0 mb-0 mt-sm-1 lh-xl-90 text-sm-center section-title-small">
          {{ section.settings.heading }}
        </h3>
    {% endcase %}
          
            {% case section.settings['sub-heading-size'] %}
     {% when 'h2' %}
        <h2 class="section-sub-title text-teal mt-0 mb-0 lh-xl-78 ps-lg-2 text-sm-center section-sub-title-medium">
          {{ section.settings.subheading }}
        </h2>
        {% when 'h3' %}
        <h3 class="section-sub-title text-teal mt-0 mb-0 lh-xl-78 ps-lg-2 text-sm-center section-sub-title-small">
          {{ section.settings.subheading }}
        </h3>
  {% endcase %}
          
            <ul class="fw-bold font-sm-13 font-lg-18 font-md-14" style="padding-left: 20px;">
             {%- if section.settings.list != blank -%}
               <li>{{section.settings.list}}</li>
             {%- endif -%}
            {%- if section.settings.list2 != blank -%}
             <li>{{section.settings.list2}}</li>
             {%- endif -%}
             {%- if section.settings.list3 != blank -%}
              <li>{{section.settings.list3}}</li>
             {%- endif -%}
             {%- if section.settings.list4 != blank -%}
              <li>{{section.settings.list4}}</li>
            {%- endif -%}
          </ul>
          <div class="d-flex justify-content-sm-center">
            <a href="{{section.settings.section-button-url}}" class="btn-black btn-sm fst-sm-12 text-uppercase mt-3">{{section.settings.section-button}}</a>
          </div>
        </div>  
      </div>
    </div>
  </div> 
</div>  
<style>
    .section-medium-title.section-title-large {
    font-size: 120px;
    color: var(--color-black);
    font-family: var(--font-Tungsten);
}

.section-medium-title.section-title-small {
    font-size: 50px;
    color: var(--color-black);
    font-family: var(--font-Tungsten);
}
  
.section-sub-title.section-sub-title-small {
    font-size: 55px;
}
  
  @media screen and (max-width: 749px){
    .section-medium-title.section-title-large {
    font-size: 60px;
    color: var(--color-black);
    font-family: var(--font-Tungsten);
}

.section-medium-title.section-title-small {
    font-size: 26px;
    color: var(--color-black);
    font-family: var(--font-Tungsten);
}

.section-medium-title.section-title-medium {
    font-size: 40px;
}
    
    .section-sub-title.section-sub-title-small {
    font-size: 35px;
}
  }
</style>

<script>
    window.__geoInfoPromise = window.__geoInfoPromise || null;

    window.getGeoInfo = function () {
        if (window.__geoInfoPromise) {
            // console.log("[GeoInfo] Reuse __geoInfoPromise");
            return window.__geoInfoPromise;
        }

        const cached = localStorage.getItem('geoInfo');
        if (cached) {
            try {
                const parsed = JSON.parse(cached);
                if (parsed && parsed.region_code) {
                    // console.log("[GeoInfo] Using data from localStorage:", parsed);
                    window.__geoInfoPromise = Promise.resolve(parsed);
                    return window.__geoInfoPromise;
                } else {
                    // console.log("[GeoInfo] Clear cache due to lack region_code");
                    localStorage.removeItem('geoInfo');
                }
            } catch (e) {
                // console.log("[GeoInfo] JSON error cache, clear cache");
                localStorage.removeItem('geoInfo');
            }
        }

        const accessKey = "{{ settings.key_ipstack }}";
        // console.log("[GeoInfo] Call API ipstack");

        window.__geoInfoPromise = fetch(`https://api.ipstack.com/check?access_key=${accessKey}`)
            .then(response => response.json())
            .then(data => {
                if (data && data.region_code) {
                    localStorage.setItem('geoInfo', JSON.stringify(data));
                    // console.log("[GeoInfo] API thành công, lưu vào localStorage:", data);
                    return data;
                } else {
                    throw new Error("Invalid geoInfo: missing region_code");
                }
            })
            .catch(error => {
                console.error("[GeoInfo] API error:", error);
                localStorage.removeItem('geoInfo');
                window.__geoInfoPromise = null;
                throw error;
            });

        return window.__geoInfoPromise;
    };

    {% assign cleanSectionID = section.id | replace: '-', '' | replace: '_', '' %}
    function section{{ cleanSectionID }}() {
        let countryCode = "{{ section.settings.country_code }}".trim();
        let hideCountry = "{{ section.settings.hide_country_code }}".trim();

        if (!countryCode && !hideCountry) {
            {% comment %}console.log("[Section {{ section.id }}] IGNORE: Both countryCode or hideCountry values ​​are empty.");{% endcomment %}
            return;
        }

        {% comment %}console.log("[Section {{ section.id }}] START processing – Country setting available.");{% endcomment %}

        const countryCodeArray = countryCode.replace(/,/g, '')
            .split(' ')
            .map(code => code.trim().toUpperCase())
            .filter(code => code);

        const hideCountryArray = hideCountry.replace(/,/g, '')
            .split(' ')
            .map(code => code.trim().toUpperCase())
            .filter(code => code);

        window.getGeoInfo().then(locationData => {
            if (!locationData || !locationData.region_code) {
                {% comment %}console.warn("[Section {{ section.id }}] Don't use region_code.");{% endcomment %}
                return;
            }

            const userRegion = locationData.region_code.toUpperCase();
            {% comment %}console.log("[Section {{ section.id }}] User region:", userRegion);{% endcomment %}

            const el = document.getElementById('shopify-section-{{ section.id }}');
            if (!el) return;

            if (countryCodeArray.length && countryCodeArray.includes(userRegion)) {
                el.style.display = 'block';
            } else if (hideCountryArray.length && hideCountryArray.includes(userRegion)) {
                el.style.display = 'none';
            } else {
                el.style.display = countryCodeArray.length > 0 ? 'none' : 'block';
            }
        });
    }

    document.addEventListener("DOMContentLoaded", function () {
        section{{ cleanSectionID }}();
    });
</script>

{% schema %}
  {
    "name": "Content List image Left",
     "class": "ipstack_content-with-list-image-left",
    "presets": [
      {
        "name": "Content List image Left",
        "category": "Content List image Left"
      }
    ],
    "settings": [
        {
 			"type": "image_picker",
 			"id": "section-image",
 			"label": "Section Image"
 	   },
       {
			"type":"text",
			"id":"heading",
			"label": "Heading Title"
		},
              {
    "type": "select",
    "id": "heading-size",
    "label": "Heading Size",
    "options": [
      {
        "value": "h1",
        "label": "Large"
      },
      {
        "value": "h2",
        "label": "Medium"
      },
      {
        "value": "h3",
        "label": "Small"
      }
    ],
    "default": "h2"
  },
      {
			"type":"text",
			"id":"subheading",
			"label": "SubTitle"
		},
               {
          "type": "select",
          "id": "sub-heading-size",
          "label": "Sub Header Size",
          "options": [

              { "value": "h2", "label": "Medium" },
              { "value": "h3", "label": "Small" }
          ],
               "default": "h2"
      },
      {
			"type":"text",
			"id":"list",
			"label": "List"
		},
        {
			"type":"text",
			"id":"list2",
			"label": "List"
		},
        {
			"type":"text",
			"id":"list3",
			"label": "List"
		},
        {
			"type":"text",
			"id":"list4",
			"label": "List"
		},
      {
 			"type": "text",
 			"id": "section-button",
 			"label": "Button Title"
 		},
		{
			"type": "url",
 			"id": "section-button-url",
 			"label": "Button Link"
		},
      {
      "type": "text",
      "id": "country_code",
      "label": "Region/State Code",
      "info": "Regions are separated by (,) For example IA, EN, HN,"
    },
    {
      "type": "text",
      "id": "hide_country_code",
      "label": "Hide Region/State Code",
      "info": "Regions are separated by (,) For example IA, EN, HN,"
    }
    ]
  }
{% endschema %}

{% stylesheet %}
{% endstylesheet %}

{% javascript %}
document.addEventListener("DOMContentLoaded", function() {
        var images = document.querySelectorAll('img[loading="lazy"]');
        images.forEach(function(img) {
            img.src = img.dataset.src;
          
        });
    });
{% endjavascript %}